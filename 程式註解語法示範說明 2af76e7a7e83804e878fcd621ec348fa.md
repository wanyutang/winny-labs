# 程式註解語法示範說明

Task-ID: TT-878
Priority: ⭐⭐⭐
Sprint: Sprint 16 (https://www.notion.so/Sprint-16-29176e7a7e838178bd96c41de1c73fe7?pvs=21)
Assignee: Winny 湯菀鈺
Status: In Progress

---

參考 https://gist.github.com/wanyutang/cf8a0d4ac1ed67e50649650b7f3121b7 以下提供**程式註解語法示範案例：** 

## **1. 目的**

- 確保程式註解與程式碼同步，提升維護效率。
- 促進團隊（含外包及 QA）快速理解程式邏輯與功能。
- 註解作為程式邏輯與客戶需求的對應文檔，減少溝通成本與錯誤。

## **2. 註解撰寫原則**

- 註解主要說明「為什麼」存在此邏輯，而非重複「程式在做什麼」。
- 註解必須與程式版本同步，避免過時或誤導。
- 需考量讀者：開發工程師、QA、新進人員、外包團隊。
- 命名清楚是基本要求，註解不可完全省略。

## **3. 語言規範**

- 程式主註解使用英文，專案名詞及 Domain Term 保留英文。
- 必要時可加中文補充，確保外包及新人理解。
- 客戶提供的功能名稱需保留原文，以便對應 QA 驗收。

---

# **4. 程式註解示範**

## **4.1 Class 與 Method 註解**

```java
/**
 * PRJ-A Service 取得會員管理後台 token 授權
 * 透過此 API 取得會員管理後台 API access token授權，供後續叫用會員管理後台 API 時使用
 *
 * @author WINNY
 */
public AccessTokenService extends ApiResBaseService<AccessTokenReq, AccessTokenRes> { ... }
```

## **4.2 Inline 註解**

```java
// 取得會員資料
AccessAuth auth = accessAuthRepository.findById(params.getAuthId())
            .orElseThrow(() -> new AIException(MessageConst.RtnCode.E9901));
```

## **4.3 命名補充註解**

```java
// 當取得電文回傳TxnDt有值時，交易日期 ＝ 電文.txn_dt
String clearingDate = response.getTxnDt();
```

## **4.4 Swagger 註解示範**

```java
@Schema(description = "取得會員管理後台 token 授權 Req")
public class AccessTokenReq {

    @Schema(description = "授權帳號")
    @NotEmpty
    @Size(min=3,max=30)
    String authId;

    @Schema(description = "授權密碼")
    @NotEmpty
    @Size(min=64,max=64)
    String authSecret;

}
```

---

# **5. API-Schema 規範**

## **5.1 欄位命名與說明**

- 需對應客戶規格命名，並保留必要中文說明。
- Swagger 註解為唯一可信 API 規格來源，用以同步 code 與現行版本行為。

## **5.2 API function 註解原則**

- 清楚說明功能目的與客戶對應名稱。
- 若涉及多個 CR 版本需註明適用版本。

---

# **6. Code-Comment SOP**

## **6.1 開發階段**

- 寫邏輯前先加上 Method Head 註解，描述目的與必要背景。
- 重要判斷前加入 inline 註解說明理由。
- 完成後自我檢查註解與程式一致性。

## **6.2 Code Review 階段**

- Reviewer 需檢查註解是否與現行流程同步。
- 若命名已不足以表達功能，需要求改善註解或優化命名。

## **6.3 維護階段**

- 修改邏輯後務必同步更新註解。
- API 變更需同步更新 Swagger，作為唯一可公開的版本規格。

---

# **7. 常見錯誤與規避**

## **錯誤 1：只寫 What 不寫 Why**

```java
// check null
if (item == null) ...
```

- 問題：無法理解為何需要這段邏輯。

```java
// why: 遠端 API 在批次處理過程中可能會傳回 null
if (item == null) ...
```

## **錯誤 2：註解重複程式碼內容**

```java
// add 1
count++;
```

## **錯誤 3：註解未更新導致誤導**

```java
// CR-112: discount always 10%
// 實際 code 已改為依會員等級動態計算
```

## **錯誤 4：API 欄位無法對應客戶規格**

```java
private String type;
```

正確示例：

```java
@Schema("fund type 基金類型")
private String fundType;
```

## **錯誤 5：全部用英文化造成理解落差**

- 外包、新人、QA 不知道 Domain Term 對應客戶用語。

---

# **8. Summary**

- 訓解是程式的一部分，必須與程式同步維護。
- 良好命名降低註解量，但不能完全取代。
- API / function / entity 註解應作為唯一可信規格參考。
- Inline 註解、Method 註解與 Swagger 註解共同形成可維護、可驗證的程式文件。
- 目標：新人可快速理解程式邏輯，QA 與外包能直接對應功能，程式版本邏輯可在 code 層查閱。

---