---
status: done
priority: normal
scheduled: 2025-11-18T00:00:00.000Z
dateCreated: 2025-11-18T09:42:51.279Z
dateModified: 2025-12-02T17:52:17.844+08:00
tags:
  - task
contexts:
  - labs
projects: []
gists:
  - id: 221b491ca8557ce3bb67043605f2f2ec
    url: https://gist.github.com/wanyutang/221b491ca8557ce3bb67043605f2f2ec
    createdAt: 2025-11-20T08:31:33.000Z
    updatedAt: 2025-12-02T09:50:12Z
    filename: winnygist.labs.程式碼註解規範工作流程.md
    isPublic: true
    baseUrl: https://api.github.com
completedDate: 2025-12-02
---


程式碼註解規範工作流程


> 先用註解寫出程式邏輯當作開發規範，並與程式一起維護，免去額外寫文件的負擔

## 流程註解同步維護

```java 
package com.demo;

/**
 * 開戶確認 Docs as Code 程式註解規範 
 * 全流程註解與程式同步設計範例
 */
public class DemoOpenAccount {

    @Autowired
    AMLComp amlComp;

    @Autowired
    EmailComp emailComp;

    @Autowired
    DEMAPI demAPI;

    /**
     * 開戶流程主要步驟 SD 註解文件
     * <pre>
     * 1. 取得開戶主檔資料
     *     1-1: 取得主檔 DB資料
     *     1-2: 解密身分證字號
     * 2. AML 黑名單檢查
     *     2-1: 呼叫 AML 合規API
     * 3. 呼叫 DEMO379 電文API並根據回傳結果更新主檔
     *     3-1: 若回傳錯誤 -> 狀態設為 E，拋例外
     *     3-2: 若成功 -> 狀態設為 C，記錄開戶帳號
     *      - 開戶電文 DEMO379 電文API = demAPI.sendOpenAccount
     *      - 主檔 DB資料 = db.getAccountInfo
     * 4. FTP 上傳
     *     4-1: 上傳失敗僅記錄log
     * 5. 驗證 Email 認證結果
     * </pre>
     */
    public DemoOpenAccountRes openAcct() {
        // 1-1. 取得主檔 DB資料
        AccountInfo info = db.getAccountInfo(session.getCaseNo());

        // 1-2. 解密身分證字號
        info.setIdNo(EncodeUtil.base64Decode(info.getIdNo()));

        // 2-1. AML 黑名單合規API電文呼叫
        String amlCode = amlComp.check(info);

        // 3. 呼叫 DEMO379 電文API並根據回傳結果更新主檔
        try {
            Demo379Response demoRes = demAPI.sendOpenAccount(info, amlCode);
            if ("E".equals(demoRes.getStatus())) {
                // 3-1. 回傳錯誤，更新主檔狀態E並拋異常
                db.updateStatus(info.getId(), "E");
                throw new Exception("DEMO379 fail");
            } else {
                // 3-2. 成功，更新主檔帳號資訊
                db.updateAccountNo(info.getId(), demoRes.getAccountNo());
            }
        } catch (Exception e) {
            System.out.println("Error on DEMO379: " + e.getMessage());
        }

        // 4. FTP 上傳流程 - 失敗僅log
        try {
            ftpAPI.uploadSeal(info);
        } catch (Exception e) {
            System.out.println("Seal FTP error: " + e.getMessage());
        }

        // 5. Email 認證流程
        boolean mailValid = emailComp.validate(info.getMail());

        return DemoOpenAccountRes.builder()
            .mail(info.getMail())
            .emailVerified(mailValid)
            .build();
    }
}
```

---

## 實施規範重點
- 方法前大註解可直接複用規格內容，並清楚標示流程步驟。
- 步驟與程式行位置一一對應，行內註解直接標示邏輯。
- 任何流程異動都同步更新註解，可當作規格書使用。
- 可設計工具協助檢查註解與規格是否一致。
## 參考來源

 - [你們在程式碼裡寫註解當作文件，最好的做法是什麼？](https://www.reddit.com/r/webdev/comments/1ae3sx9/what_are_best_practices_for_you_in_terms_of/?tl=zh-hant)
 - [寫註解的必要性？| ithome](https://ithelp.ithome.com.tw/questions/10199978)
